<!DOCTYPE html>
{% load i18n %}
{% load static %}
<html>
<head>
    <meta name="csrf-token" content="{{csrf_token}}">
    <title>{% block title %}Base Title{% endblock %}</title>
</head>
<body>
  <div id="header">
    {% block header %}
      <a href="{% url 'index' %}">{% trans "Home" %}</a> | 

      {% if user.is_authenticated %}
      {% trans "Logged in" %}: {{ user.username }} 
      (<a href="{% url 'auth_logout' %}">{% trans "Log out" %}</a> | 
      <a href="{% url 'auth_password_change' %}">{% trans "Change password" %}</a>)
      {% else %}
      <a href="{% url 'auth_login' %}">{% trans "Log in" %}</a>
      {% endif %}
      <hr />
    {% endblock %}
  </div>

  <div id="content">
    {% block content %}{% endblock %}
  </div>

  <div id="footer">
    {% block footer %}
    <hr />
    {% endblock %}
  </div>
  
  <script src="{% static 'libs/jquery.min.js' %}"></script>
  <script src="{% static 'libs/backbone/underscore-min.js' %}"></script>
  <script src="{% static 'libs/backbone/backbone-min.js' %}"></script>
	<script type="text/javascript">
    $(function(){
      var _sync = Backbone.sync;
      Backbone.sync = function(method, model, options){
        options.beforeSend = function(xhr){
          var token = $('meta[name="csrf-token"]').attr('content');
          xhr.setRequestHeader('X-CSRFToken', token);
        };
        return _sync(method, model, options);
      };
      {% block js %}
      {% endblock %}
    })
	</script>
</body>
</html>
